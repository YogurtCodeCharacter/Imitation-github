{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect } from 'react';\nimport { Button, Icon, Tabs } from 'antd';\nimport getCofnig from 'next/config';\nimport { connect } from 'react-redux';\nimport Router, { withRouter } from 'next/router';\nimport LRU from 'lru-cache';\nimport Repo from '../components/Repo';\nimport { cacheArray } from '../lib/repo-basic-cache';\n\nvar api = require('../lib/api'); // const cache = new LRU({\n//   maxAge: 1000 * 10,\n// })\n\n\nvar _getCofnig = getCofnig(),\n    publicRuntimeConfig = _getCofnig.publicRuntimeConfig;\n\nvar cachedUserRepos, cachedUserStaredRepos;\nvar isServer = false;\n\nfunction Index(_ref) {\n  _s();\n\n  var userRepos = _ref.userRepos,\n      userStaredRepos = _ref.userStaredRepos,\n      user = _ref.user,\n      router = _ref.router;\n  // console.log(userRepos, userStaredRepos)\n  var tabKey = router.query.key || '1';\n\n  var handleTabChange = function handleTabChange(activeKey) {\n    Router.push(\"/?key=\".concat(activeKey));\n  };\n\n  useEffect(function () {\n    if (!isServer) {\n      cachedUserRepos = userRepos;\n      cachedUserStaredRepos = userStaredRepos; // if (userRepos) {\n      //   cache.set('userRepos', userRepos)\n      // }\n      // if (userStaredRepos) {\n      //   cache.set('userStaredRepos', userStaredRepos)\n      // }\n\n      var timeout = setTimeout(function () {\n        cachedUserRepos = null;\n        cachedUserStaredRepos = null;\n      }, 1000 * 60 * 10);\n    }\n  }, [userRepos, userStaredRepos]);\n  useEffect(function () {\n    if (!isServer) {\n      cacheArray(userRepos);\n      cacheArray(userStaredRepos);\n    }\n  });\n\n  if (!user || !user.id) {\n    return __jsx(\"div\", {\n      className: \"jsx-4197889563\" + \" \" + \"root\"\n    }, __jsx(\"p\", {\n      className: \"jsx-4197889563\"\n    }, \"\\u4EB2\\uFF0C\\u60A8\\u8FD8\\u6CA1\\u6709\\u767B\\u5F55\\u54E6~\"), __jsx(Button, {\n      type: \"primary\",\n      href: publicRuntimeConfig.OAUTH_URL\n    }, \"\\u70B9\\u51FB\\u767B\\u5F55\"), __jsx(_JSXStyle, {\n      id: \"4197889563\"\n    }, \".root.jsx-4197889563{height:400px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96b25nbGltaW5nL0Rlc2t0b3AvSW1pdGF0aW9uLWdpdGh1Yi9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUE4RG9CLEFBRzBCLGFBQ0EsMEVBQ1MsOEVBQ0MsbUdBQ0osNkZBQ3JCIiwiZmlsZSI6Ii9Vc2Vycy96b25nbGltaW5nL0Rlc2t0b3AvSW1pdGF0aW9uLWdpdGh1Yi9wYWdlcy9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgQnV0dG9uLCBJY29uLCBUYWJzIH0gZnJvbSAnYW50ZCdcbmltcG9ydCBnZXRDb2ZuaWcgZnJvbSAnbmV4dC9jb25maWcnXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnXG5pbXBvcnQgUm91dGVyLCB7IHdpdGhSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCBMUlUgZnJvbSAnbHJ1LWNhY2hlJ1xuXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXG5pbXBvcnQgeyBjYWNoZUFycmF5IH0gZnJvbSAnLi4vbGliL3JlcG8tYmFzaWMtY2FjaGUnXG5cbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxuXG4vLyBjb25zdCBjYWNoZSA9IG5ldyBMUlUoe1xuLy8gICBtYXhBZ2U6IDEwMDAgKiAxMCxcbi8vIH0pXG5cbmNvbnN0IHsgcHVibGljUnVudGltZUNvbmZpZyB9ID0gZ2V0Q29mbmlnKClcblxubGV0IGNhY2hlZFVzZXJSZXBvcywgY2FjaGVkVXNlclN0YXJlZFJlcG9zXG5cbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcblxuZnVuY3Rpb24gSW5kZXgoeyB1c2VyUmVwb3MsIHVzZXJTdGFyZWRSZXBvcywgdXNlciwgcm91dGVyIH0pIHtcbiAgLy8gY29uc29sZS5sb2codXNlclJlcG9zLCB1c2VyU3RhcmVkUmVwb3MpXG5cbiAgY29uc3QgdGFiS2V5ID0gcm91dGVyLnF1ZXJ5LmtleSB8fCAnMSdcblxuICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSBhY3RpdmVLZXkgPT4ge1xuICAgIFJvdXRlci5wdXNoKGAvP2tleT0ke2FjdGl2ZUtleX1gKVxuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWlzU2VydmVyKSB7XG4gICAgICBjYWNoZWRVc2VyUmVwb3MgPSB1c2VyUmVwb3NcbiAgICAgIGNhY2hlZFVzZXJTdGFyZWRSZXBvcyA9IHVzZXJTdGFyZWRSZXBvc1xuICAgICAgLy8gaWYgKHVzZXJSZXBvcykge1xuICAgICAgLy8gICBjYWNoZS5zZXQoJ3VzZXJSZXBvcycsIHVzZXJSZXBvcylcbiAgICAgIC8vIH1cbiAgICAgIC8vIGlmICh1c2VyU3RhcmVkUmVwb3MpIHtcbiAgICAgIC8vICAgY2FjaGUuc2V0KCd1c2VyU3RhcmVkUmVwb3MnLCB1c2VyU3RhcmVkUmVwb3MpXG4gICAgICAvLyB9XG4gICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNhY2hlZFVzZXJSZXBvcyA9IG51bGxcbiAgICAgICAgY2FjaGVkVXNlclN0YXJlZFJlcG9zID0gbnVsbFxuICAgICAgfSwgMTAwMCAqIDYwICogMTApXG4gICAgfVxuICB9LCBbdXNlclJlcG9zLCB1c2VyU3RhcmVkUmVwb3NdKVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFpc1NlcnZlcikge1xuICAgICAgY2FjaGVBcnJheSh1c2VyUmVwb3MpXG4gICAgICBjYWNoZUFycmF5KHVzZXJTdGFyZWRSZXBvcylcbiAgICB9XG4gIH0pXG5cbiAgaWYgKCF1c2VyIHx8ICF1c2VyLmlkKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxuICAgICAgICA8cD7kurLvvIzmgqjov5jmsqHmnInnmbvlvZXlk6Z+PC9wPlxuICAgICAgICA8QnV0dG9uIHR5cGU9XCJwcmltYXJ5XCIgaHJlZj17cHVibGljUnVudGltZUNvbmZpZy5PQVVUSF9VUkx9PlxuICAgICAgICAgIOeCueWHu+eZu+W9lVxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAgIC5yb290IHtcbiAgICAgICAgICAgIGhlaWdodDogNDAwcHg7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICB9XG4gICAgICAgIGB9PC9zdHlsZT5cbiAgICAgIDwvZGl2PlxuICAgIClcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxuICAgICAgICA8aW1nIHNyYz17dXNlci5hdmF0YXJfdXJsfSBhbHQ9XCJ1c2VyIGF2YXRhclwiIGNsYXNzTmFtZT1cImF2YXRhclwiIC8+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImxvZ2luXCI+e3VzZXIubG9naW59PC9zcGFuPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJuYW1lXCI+e3VzZXIubmFtZX08L3NwYW4+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImJpb1wiPnt1c2VyLmJpb308L3NwYW4+XG4gICAgICAgIDxwIGNsYXNzTmFtZT1cImVtYWlsXCI+XG4gICAgICAgICAgPEljb24gdHlwZT1cIm1haWxcIiBzdHlsZT17eyBtYXJnaW5SaWdodDogMTAgfX0gLz5cbiAgICAgICAgICA8YSBocmVmPXtgbWFpbHRvOiR7dXNlci5lbWFpbH1gfT57dXNlci5lbWFpbH08L2E+XG4gICAgICAgIDwvcD5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9zXCI+XG4gICAgICAgIHsvKiB7dXNlclJlcG9zLm1hcChyZXBvID0+IChcbiAgICAgICAgICA8UmVwbyByZXBvPXtyZXBvfSAvPlxuICAgICAgICApKX0gKi99XG4gICAgICAgIDxUYWJzIGFjdGl2ZUtleT17dGFiS2V5fSBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfSBhbmltYXRlZD17ZmFsc2V9PlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUgdGFiPVwi5L2g55qE5LuT5bqTXCIga2V5PVwiMVwiPlxuICAgICAgICAgICAge3VzZXJSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgIDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUgdGFiPVwi5L2g5YWz5rOo55qE5LuT5bqTXCIga2V5PVwiMlwiPlxuICAgICAgICAgICAge3VzZXJTdGFyZWRSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgIDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICA8L1RhYnM+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnJvb3Qge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XG4gICAgICAgICAgcGFkZGluZzogMjBweCAwO1xuICAgICAgICB9XG4gICAgICAgIC51c2VyLWluZm8ge1xuICAgICAgICAgIHdpZHRoOiAyMDBweDtcbiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDQwcHg7XG4gICAgICAgICAgZmxleC1zaHJpbms6IDA7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICB9XG4gICAgICAgIC5sb2dpbiB7XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDtcbiAgICAgICAgICBmb250LXNpemU6IDIwcHg7XG4gICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgfVxuICAgICAgICAubmFtZSB7XG4gICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICAgIGNvbG9yOiAjNzc3O1xuICAgICAgICB9XG4gICAgICAgIC5iaW8ge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgICAgY29sb3I6ICMzMzM7XG4gICAgICAgIH1cbiAgICAgICAgLmF2YXRhciB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICB9XG4gICAgICAgIC51c2VyLXJlcG9zIHtcbiAgICAgICAgICBmbGV4LWdyb3c6IDE7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyBjdHgsIHJlZHV4U3RvcmUgfSkgPT4ge1xuICAvLyBjb25zdCByZXN1bHQgPSBhd2FpdCBheGlvc1xuICAvLyAgIC5nZXQoJy9naXRodWIvc2VhcmNoL3JlcG9zaXRvcmllcz9xPXJlYWN0JylcbiAgLy8gICAudGhlbihyZXNwID0+IGNvbnNvbGUubG9nKHJlc3ApKVxuXG4gIGNvbnN0IHVzZXIgPSByZWR1eFN0b3JlLmdldFN0YXRlKCkudXNlclxuICBjb25zb2xlLmxvZyhyZWR1eFN0b3JlKVxuICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNMb2dpbjogZmFsc2UsXG4gICAgfVxuICB9XG5cbiAgaWYgKCFpc1NlcnZlcikge1xuICAgIC8vIGlmIChjYWNoZS5nZXQoJ3VzZXJSZXBvcycpICYmIGNhY2hlLmdldCgndXNlclN0YXJlZFJlcG9zJykpIHtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHVzZXJSZXBvczogY2FjaGUuZ2V0KCd1c2VyUmVwb3MnKSxcbiAgICAvLyAgICAgdXNlclN0YXJlZFJlcG9zOiBjYWNoZS5nZXQoJ3VzZXJTdGFyZWRSZXBvcycpLFxuICAgIC8vICAgfVxuICAgIC8vIH1cblxuICAgIGlmIChjYWNoZWRVc2VyUmVwb3MgJiYgY2FjaGVkVXNlclN0YXJlZFJlcG9zKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyUmVwb3M6IGNhY2hlZFVzZXJSZXBvcyxcbiAgICAgICAgdXNlclN0YXJlZFJlcG9zOiBjYWNoZWRVc2VyU3RhcmVkUmVwb3MsXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29uc3QgdXNlclJlcG9zID0gYXdhaXQgYXBpLnJlcXVlc3QoXG4gICAge1xuICAgICAgdXJsOiAnL3VzZXIvcmVwb3MnLFxuICAgIH0sXG4gICAgY3R4LnJlcSxcbiAgICBjdHgucmVzLFxuICApXG5cbiAgY29uc3QgdXNlclN0YXJlZFJlcG9zID0gYXdhaXQgYXBpLnJlcXVlc3QoXG4gICAge1xuICAgICAgdXJsOiAnL3VzZXIvc3RhcnJlZCcsXG4gICAgfSxcbiAgICBjdHgucmVxLFxuICAgIGN0eC5yZXMsXG4gIClcblxuICByZXR1cm4ge1xuICAgIGlzTG9naW46IHRydWUsXG4gICAgdXNlclJlcG9zOiB1c2VyUmVwb3MuZGF0YSxcbiAgICB1c2VyU3RhcmVkUmVwb3M6IHVzZXJTdGFyZWRSZXBvcy5kYXRhLFxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoXG4gIGNvbm5lY3QoZnVuY3Rpb24gbWFwU3RhdGUoc3RhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjogc3RhdGUudXNlckluZm8sXG4gICAgfVxuICB9KShJbmRleCksXG4pIl19 */\\n/*@ sourceURL=/Users/zongliming/Desktop/Imitation-github/pages/index.js */\"));\n  }\n\n  return __jsx(\"div\", {\n    className: \"jsx-3879817409\" + \" \" + \"root\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3879817409\" + \" \" + \"user-info\"\n  }, __jsx(\"img\", {\n    src: user.avatar_url,\n    alt: \"user avatar\",\n    className: \"jsx-3879817409\" + \" \" + \"avatar\"\n  }), __jsx(\"span\", {\n    className: \"jsx-3879817409\" + \" \" + \"login\"\n  }, user.login), __jsx(\"span\", {\n    className: \"jsx-3879817409\" + \" \" + \"name\"\n  }, user.name), __jsx(\"span\", {\n    className: \"jsx-3879817409\" + \" \" + \"bio\"\n  }, user.bio), __jsx(\"p\", {\n    className: \"jsx-3879817409\" + \" \" + \"email\"\n  }, __jsx(Icon, {\n    type: \"mail\",\n    style: {\n      marginRight: 10\n    }\n  }), __jsx(\"a\", {\n    href: \"mailto:\".concat(user.email),\n    className: \"jsx-3879817409\"\n  }, user.email))), __jsx(\"div\", {\n    className: \"jsx-3879817409\" + \" \" + \"user-repos\"\n  }, __jsx(Tabs, {\n    activeKey: tabKey,\n    onChange: handleTabChange,\n    animated: false\n  }, __jsx(Tabs.TabPane, {\n    tab: \"\\u4F60\\u7684\\u4ED3\\u5E93\",\n    key: \"1\"\n  }, userRepos.map(function (repo) {\n    return __jsx(Repo, {\n      key: repo.id,\n      repo: repo\n    });\n  })), __jsx(Tabs.TabPane, {\n    tab: \"\\u4F60\\u5173\\u6CE8\\u7684\\u4ED3\\u5E93\",\n    key: \"2\"\n  }, userStaredRepos.map(function (repo) {\n    return __jsx(Repo, {\n      key: repo.id,\n      repo: repo\n    });\n  })))), __jsx(_JSXStyle, {\n    id: \"3879817409\"\n  }, \".root.jsx-3879817409{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:20px 0;}.user-info.jsx-3879817409{width:200px;margin-right:40px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.login.jsx-3879817409{font-weight:800;font-size:20px;margin-top:20px;}.name.jsx-3879817409{font-size:16px;color:#777;}.bio.jsx-3879817409{margin-top:20px;color:#333;}.avatar.jsx-3879817409{width:100%;border-radius:5px;}.user-repos.jsx-3879817409{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96b25nbGltaW5nL0Rlc2t0b3AvSW1pdGF0aW9uLWdpdGh1Yi9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF3R2tCLEFBR3dCLEFBS0QsQUFPSSxBQUtELEFBSUMsQUFJTCxBQUlDLFdBSE0sQ0FwQkEsR0FZUCxDQUxJLEFBU0osVUFIYixDQUlBLEVBSUEsQ0FwQmdCLENBT0UsZ0JBQ2xCLHdCQWVBLEdBN0J5QixZQU9WLDBFQUNTLHVCQVBQLGVBQ2pCLHdDQU9BIiwiZmlsZSI6Ii9Vc2Vycy96b25nbGltaW5nL0Rlc2t0b3AvSW1pdGF0aW9uLWdpdGh1Yi9wYWdlcy9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgQnV0dG9uLCBJY29uLCBUYWJzIH0gZnJvbSAnYW50ZCdcbmltcG9ydCBnZXRDb2ZuaWcgZnJvbSAnbmV4dC9jb25maWcnXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnXG5pbXBvcnQgUm91dGVyLCB7IHdpdGhSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCBMUlUgZnJvbSAnbHJ1LWNhY2hlJ1xuXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXG5pbXBvcnQgeyBjYWNoZUFycmF5IH0gZnJvbSAnLi4vbGliL3JlcG8tYmFzaWMtY2FjaGUnXG5cbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxuXG4vLyBjb25zdCBjYWNoZSA9IG5ldyBMUlUoe1xuLy8gICBtYXhBZ2U6IDEwMDAgKiAxMCxcbi8vIH0pXG5cbmNvbnN0IHsgcHVibGljUnVudGltZUNvbmZpZyB9ID0gZ2V0Q29mbmlnKClcblxubGV0IGNhY2hlZFVzZXJSZXBvcywgY2FjaGVkVXNlclN0YXJlZFJlcG9zXG5cbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcblxuZnVuY3Rpb24gSW5kZXgoeyB1c2VyUmVwb3MsIHVzZXJTdGFyZWRSZXBvcywgdXNlciwgcm91dGVyIH0pIHtcbiAgLy8gY29uc29sZS5sb2codXNlclJlcG9zLCB1c2VyU3RhcmVkUmVwb3MpXG5cbiAgY29uc3QgdGFiS2V5ID0gcm91dGVyLnF1ZXJ5LmtleSB8fCAnMSdcblxuICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSBhY3RpdmVLZXkgPT4ge1xuICAgIFJvdXRlci5wdXNoKGAvP2tleT0ke2FjdGl2ZUtleX1gKVxuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWlzU2VydmVyKSB7XG4gICAgICBjYWNoZWRVc2VyUmVwb3MgPSB1c2VyUmVwb3NcbiAgICAgIGNhY2hlZFVzZXJTdGFyZWRSZXBvcyA9IHVzZXJTdGFyZWRSZXBvc1xuICAgICAgLy8gaWYgKHVzZXJSZXBvcykge1xuICAgICAgLy8gICBjYWNoZS5zZXQoJ3VzZXJSZXBvcycsIHVzZXJSZXBvcylcbiAgICAgIC8vIH1cbiAgICAgIC8vIGlmICh1c2VyU3RhcmVkUmVwb3MpIHtcbiAgICAgIC8vICAgY2FjaGUuc2V0KCd1c2VyU3RhcmVkUmVwb3MnLCB1c2VyU3RhcmVkUmVwb3MpXG4gICAgICAvLyB9XG4gICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNhY2hlZFVzZXJSZXBvcyA9IG51bGxcbiAgICAgICAgY2FjaGVkVXNlclN0YXJlZFJlcG9zID0gbnVsbFxuICAgICAgfSwgMTAwMCAqIDYwICogMTApXG4gICAgfVxuICB9LCBbdXNlclJlcG9zLCB1c2VyU3RhcmVkUmVwb3NdKVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFpc1NlcnZlcikge1xuICAgICAgY2FjaGVBcnJheSh1c2VyUmVwb3MpXG4gICAgICBjYWNoZUFycmF5KHVzZXJTdGFyZWRSZXBvcylcbiAgICB9XG4gIH0pXG5cbiAgaWYgKCF1c2VyIHx8ICF1c2VyLmlkKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxuICAgICAgICA8cD7kurLvvIzmgqjov5jmsqHmnInnmbvlvZXlk6Z+PC9wPlxuICAgICAgICA8QnV0dG9uIHR5cGU9XCJwcmltYXJ5XCIgaHJlZj17cHVibGljUnVudGltZUNvbmZpZy5PQVVUSF9VUkx9PlxuICAgICAgICAgIOeCueWHu+eZu+W9lVxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAgIC5yb290IHtcbiAgICAgICAgICAgIGhlaWdodDogNDAwcHg7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICB9XG4gICAgICAgIGB9PC9zdHlsZT5cbiAgICAgIDwvZGl2PlxuICAgIClcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxuICAgICAgICA8aW1nIHNyYz17dXNlci5hdmF0YXJfdXJsfSBhbHQ9XCJ1c2VyIGF2YXRhclwiIGNsYXNzTmFtZT1cImF2YXRhclwiIC8+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImxvZ2luXCI+e3VzZXIubG9naW59PC9zcGFuPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJuYW1lXCI+e3VzZXIubmFtZX08L3NwYW4+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImJpb1wiPnt1c2VyLmJpb308L3NwYW4+XG4gICAgICAgIDxwIGNsYXNzTmFtZT1cImVtYWlsXCI+XG4gICAgICAgICAgPEljb24gdHlwZT1cIm1haWxcIiBzdHlsZT17eyBtYXJnaW5SaWdodDogMTAgfX0gLz5cbiAgICAgICAgICA8YSBocmVmPXtgbWFpbHRvOiR7dXNlci5lbWFpbH1gfT57dXNlci5lbWFpbH08L2E+XG4gICAgICAgIDwvcD5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9zXCI+XG4gICAgICAgIHsvKiB7dXNlclJlcG9zLm1hcChyZXBvID0+IChcbiAgICAgICAgICA8UmVwbyByZXBvPXtyZXBvfSAvPlxuICAgICAgICApKX0gKi99XG4gICAgICAgIDxUYWJzIGFjdGl2ZUtleT17dGFiS2V5fSBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfSBhbmltYXRlZD17ZmFsc2V9PlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUgdGFiPVwi5L2g55qE5LuT5bqTXCIga2V5PVwiMVwiPlxuICAgICAgICAgICAge3VzZXJSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgIDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUgdGFiPVwi5L2g5YWz5rOo55qE5LuT5bqTXCIga2V5PVwiMlwiPlxuICAgICAgICAgICAge3VzZXJTdGFyZWRSZXBvcy5tYXAocmVwbyA9PiAoXG4gICAgICAgICAgICAgIDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICA8L1RhYnM+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnJvb3Qge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XG4gICAgICAgICAgcGFkZGluZzogMjBweCAwO1xuICAgICAgICB9XG4gICAgICAgIC51c2VyLWluZm8ge1xuICAgICAgICAgIHdpZHRoOiAyMDBweDtcbiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDQwcHg7XG4gICAgICAgICAgZmxleC1zaHJpbms6IDA7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICB9XG4gICAgICAgIC5sb2dpbiB7XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDtcbiAgICAgICAgICBmb250LXNpemU6IDIwcHg7XG4gICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgfVxuICAgICAgICAubmFtZSB7XG4gICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICAgIGNvbG9yOiAjNzc3O1xuICAgICAgICB9XG4gICAgICAgIC5iaW8ge1xuICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgICAgY29sb3I6ICMzMzM7XG4gICAgICAgIH1cbiAgICAgICAgLmF2YXRhciB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICB9XG4gICAgICAgIC51c2VyLXJlcG9zIHtcbiAgICAgICAgICBmbGV4LWdyb3c6IDE7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyBjdHgsIHJlZHV4U3RvcmUgfSkgPT4ge1xuICAvLyBjb25zdCByZXN1bHQgPSBhd2FpdCBheGlvc1xuICAvLyAgIC5nZXQoJy9naXRodWIvc2VhcmNoL3JlcG9zaXRvcmllcz9xPXJlYWN0JylcbiAgLy8gICAudGhlbihyZXNwID0+IGNvbnNvbGUubG9nKHJlc3ApKVxuXG4gIGNvbnN0IHVzZXIgPSByZWR1eFN0b3JlLmdldFN0YXRlKCkudXNlclxuICBjb25zb2xlLmxvZyhyZWR1eFN0b3JlKVxuICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNMb2dpbjogZmFsc2UsXG4gICAgfVxuICB9XG5cbiAgaWYgKCFpc1NlcnZlcikge1xuICAgIC8vIGlmIChjYWNoZS5nZXQoJ3VzZXJSZXBvcycpICYmIGNhY2hlLmdldCgndXNlclN0YXJlZFJlcG9zJykpIHtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHVzZXJSZXBvczogY2FjaGUuZ2V0KCd1c2VyUmVwb3MnKSxcbiAgICAvLyAgICAgdXNlclN0YXJlZFJlcG9zOiBjYWNoZS5nZXQoJ3VzZXJTdGFyZWRSZXBvcycpLFxuICAgIC8vICAgfVxuICAgIC8vIH1cblxuICAgIGlmIChjYWNoZWRVc2VyUmVwb3MgJiYgY2FjaGVkVXNlclN0YXJlZFJlcG9zKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyUmVwb3M6IGNhY2hlZFVzZXJSZXBvcyxcbiAgICAgICAgdXNlclN0YXJlZFJlcG9zOiBjYWNoZWRVc2VyU3RhcmVkUmVwb3MsXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29uc3QgdXNlclJlcG9zID0gYXdhaXQgYXBpLnJlcXVlc3QoXG4gICAge1xuICAgICAgdXJsOiAnL3VzZXIvcmVwb3MnLFxuICAgIH0sXG4gICAgY3R4LnJlcSxcbiAgICBjdHgucmVzLFxuICApXG5cbiAgY29uc3QgdXNlclN0YXJlZFJlcG9zID0gYXdhaXQgYXBpLnJlcXVlc3QoXG4gICAge1xuICAgICAgdXJsOiAnL3VzZXIvc3RhcnJlZCcsXG4gICAgfSxcbiAgICBjdHgucmVxLFxuICAgIGN0eC5yZXMsXG4gIClcblxuICByZXR1cm4ge1xuICAgIGlzTG9naW46IHRydWUsXG4gICAgdXNlclJlcG9zOiB1c2VyUmVwb3MuZGF0YSxcbiAgICB1c2VyU3RhcmVkUmVwb3M6IHVzZXJTdGFyZWRSZXBvcy5kYXRhLFxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoXG4gIGNvbm5lY3QoZnVuY3Rpb24gbWFwU3RhdGUoc3RhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjogc3RhdGUudXNlckluZm8sXG4gICAgfVxuICB9KShJbmRleCksXG4pIl19 */\\n/*@ sourceURL=/Users/zongliming/Desktop/Imitation-github/pages/index.js */\"));\n}\n\n_s(Index, \"3ubReDTFssvu4DHeldAg55cW/CI=\");\n\n_c = Index;\n\nIndex.getInitialProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n    var ctx, reduxStore, user, userRepos, userStaredRepos;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ctx = _ref2.ctx, reduxStore = _ref2.reduxStore;\n            // const result = await axios\n            //   .get('/github/search/repositories?q=react')\n            //   .then(resp => console.log(resp))\n            user = reduxStore.getState().user;\n            console.log(reduxStore);\n\n            if (!(!user || !user.id)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              isLogin: false\n            });\n\n          case 5:\n            if (isServer) {\n              _context.next = 8;\n              break;\n            }\n\n            if (!(cachedUserRepos && cachedUserStaredRepos)) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              userRepos: cachedUserRepos,\n              userStaredRepos: cachedUserStaredRepos\n            });\n\n          case 8:\n            _context.next = 10;\n            return api.request({\n              url: '/user/repos'\n            }, ctx.req, ctx.res);\n\n          case 10:\n            userRepos = _context.sent;\n            _context.next = 13;\n            return api.request({\n              url: '/user/starred'\n            }, ctx.req, ctx.res);\n\n          case 13:\n            userStaredRepos = _context.sent;\n            return _context.abrupt(\"return\", {\n              isLogin: true,\n              userRepos: userRepos.data,\n              userStaredRepos: userStaredRepos.data\n            });\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nexport default withRouter(connect(function mapState(state) {\n  return {\n    user: state.userInfo\n  };\n})(Index));\n\nvar _c;\n\n$RefreshReg$(_c, \"Index\");","map":{"version":3,"sources":["/Users/zongliming/Desktop/Imitation-github/pages/index.js"],"names":["useEffect","Button","Icon","Tabs","getCofnig","connect","Router","withRouter","LRU","Repo","cacheArray","api","require","publicRuntimeConfig","cachedUserRepos","cachedUserStaredRepos","isServer","Index","userRepos","userStaredRepos","user","router","tabKey","query","key","handleTabChange","activeKey","push","timeout","setTimeout","id","OAUTH_URL","avatar_url","login","name","bio","marginRight","email","map","repo","getInitialProps","ctx","reduxStore","getState","console","log","isLogin","request","url","req","res","data","mapState","state","userInfo"],"mappings":"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","sourcesContent":["import { useEffect } from 'react'\nimport { Button, Icon, Tabs } from 'antd'\nimport getCofnig from 'next/config'\nimport { connect } from 'react-redux'\nimport Router, { withRouter } from 'next/router'\nimport LRU from 'lru-cache'\n\nimport Repo from '../components/Repo'\nimport { cacheArray } from '../lib/repo-basic-cache'\n\nconst api = require('../lib/api')\n\n// const cache = new LRU({\n//   maxAge: 1000 * 10,\n// })\n\nconst { publicRuntimeConfig } = getCofnig()\n\nlet cachedUserRepos, cachedUserStaredRepos\n\nconst isServer = typeof window === 'undefined'\n\nfunction Index({ userRepos, userStaredRepos, user, router }) {\n  // console.log(userRepos, userStaredRepos)\n\n  const tabKey = router.query.key || '1'\n\n  const handleTabChange = activeKey => {\n    Router.push(`/?key=${activeKey}`)\n  }\n\n  useEffect(() => {\n    if (!isServer) {\n      cachedUserRepos = userRepos\n      cachedUserStaredRepos = userStaredRepos\n      // if (userRepos) {\n      //   cache.set('userRepos', userRepos)\n      // }\n      // if (userStaredRepos) {\n      //   cache.set('userStaredRepos', userStaredRepos)\n      // }\n      const timeout = setTimeout(() => {\n        cachedUserRepos = null\n        cachedUserStaredRepos = null\n      }, 1000 * 60 * 10)\n    }\n  }, [userRepos, userStaredRepos])\n\n  useEffect(() => {\n    if (!isServer) {\n      cacheArray(userRepos)\n      cacheArray(userStaredRepos)\n    }\n  })\n\n  if (!user || !user.id) {\n    return (\n      <div className=\"root\">\n        <p>亲，您还没有登录哦~</p>\n        <Button type=\"primary\" href={publicRuntimeConfig.OAUTH_URL}>\n          点击登录\n        </Button>\n        <style jsx>{`\n          .root {\n            height: 400px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n          }\n        `}</style>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"root\">\n      <div className=\"user-info\">\n        <img src={user.avatar_url} alt=\"user avatar\" className=\"avatar\" />\n        <span className=\"login\">{user.login}</span>\n        <span className=\"name\">{user.name}</span>\n        <span className=\"bio\">{user.bio}</span>\n        <p className=\"email\">\n          <Icon type=\"mail\" style={{ marginRight: 10 }} />\n          <a href={`mailto:${user.email}`}>{user.email}</a>\n        </p>\n      </div>\n      <div className=\"user-repos\">\n        {/* {userRepos.map(repo => (\n          <Repo repo={repo} />\n        ))} */}\n        <Tabs activeKey={tabKey} onChange={handleTabChange} animated={false}>\n          <Tabs.TabPane tab=\"你的仓库\" key=\"1\">\n            {userRepos.map(repo => (\n              <Repo key={repo.id} repo={repo} />\n            ))}\n          </Tabs.TabPane>\n          <Tabs.TabPane tab=\"你关注的仓库\" key=\"2\">\n            {userStaredRepos.map(repo => (\n              <Repo key={repo.id} repo={repo} />\n            ))}\n          </Tabs.TabPane>\n        </Tabs>\n      </div>\n      <style jsx>{`\n        .root {\n          display: flex;\n          align-items: flex-start;\n          padding: 20px 0;\n        }\n        .user-info {\n          width: 200px;\n          margin-right: 40px;\n          flex-shrink: 0;\n          display: flex;\n          flex-direction: column;\n        }\n        .login {\n          font-weight: 800;\n          font-size: 20px;\n          margin-top: 20px;\n        }\n        .name {\n          font-size: 16px;\n          color: #777;\n        }\n        .bio {\n          margin-top: 20px;\n          color: #333;\n        }\n        .avatar {\n          width: 100%;\n          border-radius: 5px;\n        }\n        .user-repos {\n          flex-grow: 1;\n        }\n      `}</style>\n    </div>\n  )\n}\n\nIndex.getInitialProps = async ({ ctx, reduxStore }) => {\n  // const result = await axios\n  //   .get('/github/search/repositories?q=react')\n  //   .then(resp => console.log(resp))\n\n  const user = reduxStore.getState().user\n  console.log(reduxStore)\n  if (!user || !user.id) {\n    return {\n      isLogin: false,\n    }\n  }\n\n  if (!isServer) {\n    // if (cache.get('userRepos') && cache.get('userStaredRepos')) {\n    //   return {\n    //     userRepos: cache.get('userRepos'),\n    //     userStaredRepos: cache.get('userStaredRepos'),\n    //   }\n    // }\n\n    if (cachedUserRepos && cachedUserStaredRepos) {\n      return {\n        userRepos: cachedUserRepos,\n        userStaredRepos: cachedUserStaredRepos,\n      }\n    }\n  }\n\n  const userRepos = await api.request(\n    {\n      url: '/user/repos',\n    },\n    ctx.req,\n    ctx.res,\n  )\n\n  const userStaredRepos = await api.request(\n    {\n      url: '/user/starred',\n    },\n    ctx.req,\n    ctx.res,\n  )\n\n  return {\n    isLogin: true,\n    userRepos: userRepos.data,\n    userStaredRepos: userStaredRepos.data,\n  }\n}\n\nexport default withRouter(\n  connect(function mapState(state) {\n    return {\n      user: state.userInfo,\n    }\n  })(Index),\n)"]},"metadata":{},"sourceType":"module"}